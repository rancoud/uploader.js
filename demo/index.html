<!DOCTYPE html>
<html data-theme="dark" lang="en">
<head>
    <meta charset="UTF-8">
    <title>uploader.js Demo</title>
    <style>
        /* Styling the page in general */
        * {
            font-family: sans-serif;
        }

        html {
            background-color: #fff;
            color: #000;
            height: 100%;
        }

        html[data-theme=dark] {
            background-color: #000;
            color: #fff;
        }

        body {
            height: calc(100% - 57px);
            margin: 0;
            overflow: hidden;
        }

        .header {
            align-content: center;
            align-items: center;
            border-bottom: 1px solid grey;
            display: flex;
            justify-content: space-between;
            padding: 10px;
        }

        h1 {
            margin: 0;
            padding: 0;
        }

        .button-switch-theme {
            padding: 5px;
        }

        .wrapper {
            box-sizing: border-box;
            display: flex;
            height: 100%;
            margin: 0;
            overflow: hidden;
        }

        .sidebar {
            border-right: 1px solid grey;
            min-width: 200px;
            overflow-y: auto;
            padding: 10px;
        }

        .sidebar p {
            font-size: 18px;
        }

        .sidebar__list {
            list-style: none;
            padding: 5px 5px 5px 5px;
        }

        .sidebar__list li:hover {
            background-color: #eeeeee;
        }

        html[data-theme=dark] .sidebar__list li:hover {
            background-color: #2a2a2a;
        }

        .sidebar__list a {
            color: #585858;
            display: inline-block;
            padding: 5px;
            width: 100%;
        }

        html[data-theme=dark] .sidebar__list a {
            color: #969696;
        }

        .content {
            flex-grow: 1;
            overflow-y: auto;
            padding: 10px;
        }
    </style>
    <style>
        /* Styling the page for uploader.js */
    </style>
</head>
<body>
    <div class="header">
        <h1>uploader.js Demo</h1>
        <button class="button-switch-theme" id="button-switch-theme" onclick="switchTheme();">Switch to Light Theme</button>
    </div>
    <div class="wrapper">
        <div class="sidebar">
            <p>Examples</p>
            <ul class="sidebar__list">
                <li><a href="#simple">Simple</a></li>
                <li><a href="#simple-cancel">Simple + Cancel</a></li>
                <li><a href="#simple-save">Simple + Save (upload url will be current location)</a></li>
                <li><a href="#simple-save-upload_url">Simple + Save + upload url</a></li>
                <li><a href="#simple-save-upload_name">Simple + Save + upload name "toto"</a></li>
                <li><a href="#simple-save-upload-prefix">Simple + Save + upload prefix "my_prefix_"</a></li>
                <li><a href="#simple-mask-square">Simple + Mask square</a></li>
                <li><a href="#simple-mask-rectangle">Simple + Mask rectangle + color yellow</a></li>
                <li><a href="#simple-mask-radius-10">Simple + Mask + radius 10</a></li>
                <li><a href="#simple-mask-radius-200">Simple + Mask + radius 200</a></li>
                <li><a href="#simple-mask-rectangle-radius-200">Simple + Mask rectangle + radius 200</a></li>
                <li><a href="#simple-mask-no-constraint">Simple + Mask + no constraint</a></li>
                <li><a href="#simple-div_upload">Simple + div upload</a></li>
                <li><a href="#simple-div_preview">Simple + div preview</a></li>
                <li><a href="#simple-div_error-onload">Simple + div error onload image</a></li>
                <li><a href="#simple-scale_factor_2">Simple + scale factor 2</a></li>
                <li><a href="#simple-css-canvas_moving">Simple + css canvas moving</a></li>
            </ul>
        </div>
        <div class="content">
            <div id="simple">
                <h2>Simple</h2>

                <div data-live="simple-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-canvas"
                     data-uploader-input_file-id="simple-input_file"
                >
                    <canvas id="simple-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-input_file"/>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-live-html"></pre>
            </div>

            <hr />

            <div id="simple-cancel">
                <h2>Simple + Cancel</h2>

                <div data-live="simple-cancel-live-html"
                        data-uploader
                        data-uploader-canvas-id="simple-cancel-canvas"
                        data-uploader-input_file-id="simple-cancel-input_file"
                        data-uploader-btn_cancel-id="simple-cancel-btn"
                >
                    <canvas id="simple-cancel-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-cancel-input_file"/>
                    <button id="simple-cancel-btn">cancel</button>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-cancel-live-html"></pre>
            </div>

            <hr />

            <div id="simple-save">
                <h2>Simple + Save (upload url will be current location)</h2>

                <div data-live="simple-save-live-html"
                        data-uploader
                        data-uploader-canvas-id="simple-save-canvas"
                        data-uploader-input_file-id="simple-save-input_file"
                        data-uploader-btn_save-id="simple-save-btn"
                >
                    <canvas id="simple-save-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-save-input_file"/>
                    <button id="simple-save-btn">save</button>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-save-live-html"></pre>
            </div>

            <hr />

            <div id="simple-save-upload_url">
                <h2>Simple + Save + upload url</h2>

                <div data-live="simple-save-upload_url-live-html"
                        data-uploader
                        data-uploader-canvas-id="simple-save-upload_url-canvas"
                        data-uploader-input_file-id="simple-save-upload_url-input_file"
                        data-uploader-btn_save-id="simple-save-upload_url-btn"
                        data-uploader-upload-url="/custom-url"
                >
                    <canvas id="simple-save-upload_url-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-save-upload_url-input_file"/>
                    <button id="simple-save-upload_url-btn">save</button>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-save-upload_url-live-html"></pre>
            </div>

            <hr />

            <div id="simple-save-upload_name">
                <h2>Simple + Save + upload name "toto"</h2>

                <div data-live="simple-save-upload_name-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-save-upload_name-canvas"
                     data-uploader-input_file-id="simple-save-upload_name-input_file"
                     data-uploader-btn_save-id="simple-save-upload_name-btn"
                     data-uploader-upload-name="toto"
                >
                    <canvas id="simple-save-upload_name-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-save-upload_name-input_file"/>
                    <button id="simple-save-upload_name-btn">save</button>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-save-upload_name-live-html"></pre>
            </div>

            <hr />

            <div id="simple-save-upload-prefix">
                <h2>Simple + Save + upload prefix "my_prefix_"</h2>

                <div data-live="simple-save-upload-prefix-live-html"
                        data-uploader
                        data-uploader-canvas-id="simple-save-upload-prefix-canvas"
                        data-uploader-input_file-id="simple-save-upload-prefix-input_file"
                        data-uploader-btn_save-id="simple-save-upload-prefix-btn"
                        data-uploader-upload-prefix="my_prefix_"
                >
                    <canvas id="simple-save-upload-prefix-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-save-upload-prefix-input_file"/>
                    <button id="simple-save-upload-prefix-btn">save</button>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-save-upload-prefix-live-html"></pre>
            </div>

            <hr />

            <div id="simple-mask-square">
                <h2>Simple + Mask square</h2>

                <div data-live="simple-mask-square-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-mask-square-canvas"
                     data-uploader-input_file-id="simple-mask-square-input_file"
                     data-uploader-mask-size="150"
                >
                    <canvas id="simple-mask-square-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-mask-square-input_file"/>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-mask-square-live-html"></pre>
            </div>

            <hr />

            <div id="simple-mask-rectangle">
                <h2>Simple + Mask rectangle + color yellow</h2>

                <div data-live="simple-mask-rectangle-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-mask-rectangle-canvas"
                     data-uploader-input_file-id="simple-mask-rectangle-input_file"
                     data-uploader-mask-size="150,50"
                     data-uploader-mask-color="rgba(255, 255, 0, 0.3)"
                >
                    <canvas id="simple-mask-rectangle-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-mask-rectangle-input_file"/>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-mask-rectangle-live-html"></pre>
            </div>

            <hr />

            <div id="simple-mask-radius-10">
                <h2>Simple + Mask + radius 10</h2>

                <div data-live="simple-mask-radius-10-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-mask-radius-10-canvas"
                     data-uploader-input_file-id="simple-mask-radius-10-input_file"
                     data-uploader-mask-size="150"
                     data-uploader-mask-radius="10"
                >
                    <canvas id="simple-mask-radius-10-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-mask-radius-10-input_file"/>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-mask-radius-10-live-html"></pre>
            </div>

            <hr />

            <div id="simple-mask-radius-200">
                <h2>Simple + Mask + radius 200 (to have circle)</h2>

                <div data-live="simple-mask-radius-200-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-mask-radius-200-canvas"
                     data-uploader-input_file-id="simple-mask-radius-200-input_file"
                     data-uploader-mask-size="150"
                     data-uploader-mask-radius="200"
                >
                    <canvas id="simple-mask-radius-200-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-mask-radius-200-input_file"/>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-mask-radius-200-live-html"></pre>
            </div>

            <hr />

            <div id="simple-mask-rectangle-radius-200">
                <h2>Simple + Mask rectangle + radius 200</h2>

                <div data-live="simple-mask-rectangle-radius-200-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-mask-rectangle-radius-200-canvas"
                     data-uploader-input_file-id="simple-mask-rectangle-radius-200-input_file"
                     data-uploader-mask-size="150,50"
                     data-uploader-mask-radius="200"
                >
                    <canvas id="simple-mask-rectangle-radius-200-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-mask-rectangle-radius-200-input_file"/>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-mask-rectangle-radius-200-live-html"></pre>
            </div>

            <hr />

            <div id="simple-mask-no-constraint">
                <h2>Simple + Mask + no constraint</h2>

                <div data-live="simple-mask-no-constraint-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-mask-no-constraint-canvas"
                     data-uploader-input_file-id="simple-mask-no-constraint-input_file"
                     data-uploader-mask-size="150"
                     data-uploader-mask-constraint="false"
                >
                    <canvas id="simple-mask-no-constraint-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-mask-no-constraint-input_file"/>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-mask-no-constraint-live-html"></pre>
            </div>

            <hr />

            <div id="simple-div_upload">
                <h2>Simple + div upload (+ cancel for non blocking demo)</h2>

                <div data-live="simple-div_upload-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-div_upload-canvas"
                     data-uploader-input_file-id="simple-div_upload-input_file"
                     data-uploader-div_upload-id="simple-div_upload-div"
                     data-uploader-btn_cancel-id="simple-div_upload-cancel"
                >
                    <canvas id="simple-div_upload-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <div id="simple-div_upload-div"><input type="file" id="simple-div_upload-input_file"/></div>
                    <button id="simple-div_upload-cancel">cancel</button>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-div_upload-live-html"></pre>
            </div>

            <hr />

            <div id="simple-div_preview">
                <h2>Simple + div preview (+ cancel for non blocking demo)</h2>

                <div data-live="simple-div_preview-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-div_preview-canvas"
                     data-uploader-input_file-id="simple-div_preview-input_file"
                     data-uploader-div_preview-id="simple-div_preview-div"
                     data-uploader-btn_cancel-id="simple-div_preview-cancel"
                >
                    <div id="simple-div_preview-div"><canvas id="simple-div_preview-canvas" width="200" height="200" style="border: 1px solid grey"></canvas></div>
                    <input type="file" id="simple-div_preview-input_file"/>
                    <button id="simple-div_preview-cancel">cancel</button>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-div_preview-live-html"></pre>
            </div>

            <hr />

            <div id="simple-div_error-onload">
                <h2>Simple + div error onload image (+ cancel for non blocking demo)</h2>

                <div data-live="simple-div_error-onload-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-div_error-onload-canvas"
                     data-uploader-input_file-id="simple-div_error-onload-input_file"
                     data-uploader-div_error-id="simple-div_error-onload-div"
                     data-uploader-btn_cancel-id="simple-div_error-onload-cancel"
                >
                    <div id="simple-div_error-onload-div">Error here</div>
                    <canvas id="simple-div_error-onload-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-div_error-onload-input_file"/>
                    <button id="simple-div_error-onload-cancel">cancel</button>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-div_error-onload-live-html"></pre>
            </div>

            <hr />

            <div id="simple-scale_factor_2">
                <h2>Simple + scale factor 2</h2>

                <div data-live="simple-scale_factor_2-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-scale_factor_2-canvas"
                     data-uploader-input_file-id="simple-scale_factor_2-input_file"
                     data-uploader-scale_factor="2.1"
                >
                    <canvas id="simple-scale_factor_2-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-scale_factor_2-input_file"/>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-scale_factor_2-live-html"></pre>
            </div>

            <hr />

            <div id="simple-css-canvas_moving">
                <h2>Simple + css canvas moving</h2>

                <style>.canvas_move{
                    border: 5px solid red !important;
                }</style>

                <div data-live="simple-css-canvas_moving-live-html"
                     data-uploader
                     data-uploader-canvas-id="simple-css-canvas_moving-canvas"
                     data-uploader-input_file-id="simple-css-canvas_moving-input_file"
                     data-uploader-css-canvas_moving="canvas_move"
                >
                    <canvas id="simple-css-canvas_moving-canvas" width="200" height="200" style="border: 1px solid grey"></canvas>
                    <input type="file" id="simple-css-canvas_moving-input_file"/>
                </div>

                <span class="live-html">Live HTML</span>
                <pre id="simple-css-canvas_moving-live-html"></pre>
            </div>

            <hr />
        </div>
    </div>

    <script src="../dist/uploader.js"></script>

    <script>
        function switchTheme(e) {
            var theme = document.querySelector("html").getAttribute("data-theme");
            if (theme === "light") {
                document.querySelector("html").setAttribute("data-theme", "dark");
                document.getElementById("button-switch-theme").textContent = "Switch to Light Theme";
            } else {
                document.querySelector("html").setAttribute("data-theme", "light");
                document.getElementById("button-switch-theme").textContent = "Switch to Dark Theme";
            }
        }
    </script>
    <script>
        var uploaderDomRoot = document.querySelectorAll('div[data-uploader]');
        var idxNodes = 0;
        var maxNodes = uploaderDomRoot.length;

        for (; idxNodes < maxNodes; ++idxNodes) {
            var uploader = new Uploader(uploaderDomRoot[idxNodes]);
            if (uploader instanceof Error) {
                console.error('[uploader.js] ' + uploader);
            }

            document.getElementById(uploaderDomRoot[idxNodes].getAttribute("data-live")).innerText = uploaderDomRoot[idxNodes].outerHTML;

            new MutationObserver(function(mutations, observer) {
                var uploaderDomRoot = mutations[0].target.closest("div[data-uploader]");
                document.getElementById(uploaderDomRoot.getAttribute("data-live")).innerText = uploaderDomRoot.outerHTML;
            }).observe(uploaderDomRoot[idxNodes], {
                subtree: true,
                attributes: true,
                childList: true
            });
        }
    </script>
</body>
</html>
